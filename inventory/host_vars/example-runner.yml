---
# A list of runners to register and configure for this VM
gitlab_runner_runners:
  - name: "shell-runner"
    limit: 0
    token: "{{ shell_runner_name }}"
    # set to 'absent' if you want to delete the runner. Defaults to 'present'.
    state: present
    # The executor used by the runner.
    executor: shell
    # Set maximum build log size in kilobytes.
    output_limit: 8192
    # Defaults to 0, no, no limit
    concurrent_specific: "0"
    # actually these are generated by group/project gitlab-runner settings
    tags:
      - shell
    # Indicates whether this runner can pick jobs without tags.
    run_untagged: false
    # Indicates whether this runner should only pick jobs from protected branches.
    protected: false
    # Runner Locked. When a runner is locked, it cannot be assigned to other projects
    locked: "true"
    env_vars: []

  - name: "dind-runner"
    limit: 0
    token: "{{ dind_runner_name }}"
    executor: docker
    output_limit: 8192
    docker_image: "docker:29.2.1-dind"
    tags:
      - dind
    docker_network_mode: bridge
    env_vars:
      - "DOCKER_DRIVER=overlay2"
    docker_volumes:
      - "/var/run/docker.sock:/var/run/docker.sock"
      - "/cache"
    extra_configs:
      runners.docker:
        privileged: true
        tls_verify: false
        disable_entrypoint_overwrite: false
        oom_kill_disable: false
        disable_cache: false

  - name: "docker-runner"
    limit: 0
    token: "{{ docker_runner_name }}"
    executor: docker
    output_limit: 8192
    # this can be overwritten by setting in .gitlab-ci.yml
    docker_image: "alpine:latest"
    tags:
      - docker
    docker_priviledged: false
    docker_network_mode: bridge
    env_vars:
      - "DOCKER_DRIVER=overlay2"
    # Need a cron job to do docker volume prune -af
    docker_volumes:
      - "/cache"
    extra_configs:
      runners.docker:
        tls_verify: false
        privileged: false
        disable_entrypoint_overwrite: false
        oom_kill_disable: false
        disable_cache: false

# sudo passwd
# ansible_sudo_pass: "YourPasswdHere"
